<!DOCTYPE html><html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta description="Synth is a back-end web framework designed to make (Angular|Ember|Backbone)JS web apps easy to create and manage."><title>Synth - The back-end web framework designed to make
(Angular|Ember|Backbone)JS web apps easy to create and manage.</title><link rel="stylesheet" href="//cdn.jsdelivr.net/bootstrap/3.1/css/bootstrap.min.css"><link rel="stylesheet" href="/bower_components/prismjs/prism.css"><link rel="stylesheet" href="/css/main.css"><link rel="icon" type="image/png" href="/favicon.png"></head><body data-spy="scroll" data-target=".toc"><nav class="navbar navbar-default navbar-static-top"><div class="container"><div class="navbar-header"><button type="button" data-toggle="collapse" data-target="#synth-links" class="navbar-toggle"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a href="/" class="navbar-brand">Synth</a></div><div id="synth-links" class="collapse navbar-collapse navbar-right"><ul class="nav navbar-nav"><li class="features"><a href="/features">Features</a></li><li class="docs"><a href="/docs">Docs</a></li><li class="tutorial"><a href="/tutorial">Tutorial</a></li><li class="examples"><a href="/examples">Examples</a></li><li class="source"><a href="https://github.com/JonAbrams/synth">Source</a></li></ul></div></div></nav><div class="container"><div class="row"><div class="col-md-3"><div class="toc"><h2>Tutorial</h2><ul class="nav"><li class="section"><a href="#intro">Intro</a></li><li class="section"><a href="#setup">Setup</a><ul class="nav"><li><a href="#dependencies">Dependencies</a></li><li><a href="#install">Install Synth</a></li><li><a href="#create-app">Create new app</a></li><li><a href="#starting">Starting the app</a></li><li><a href="#populate-db">Pre-popluate the DB</a></li></ul></li><li class="section"><a href="#publish">Add Tweeting</a><ul class="nav"><li><a href="#create-post-method">Add a POST method</a></li><li><a href="#create-publish-method">Add a publish method</a></li><li><a href="#add-textarea-and-button">Add a textarea</a></li></ul></li></ul></div></div><div class="contents col-md-9"><p><div id="intro"></div></p>
<h1>Intro</h1>
<p>This guide will walk you through the steps necessary to add some extra functionality to the default app generated by synth.</p>
<p>The default app created by synth is a very limited version of twitter. Out of the box it just displays a list of tweets.</p>
<p>It&#39;s currently missing some basic functionality:</p>
<ul>
<li>There&#39;s no way to publish new tweets.</li>
<li>There&#39;s no way to link to a particular tweet.</li>
<li>All tweets are anonymous, how boring!</li>
</ul>
<p>This guide will walk you through setting up synth, creating the project, and then show you how to add the above mentioned missing functionality.</p>
<p><div id="setup"></div></p>
<h1>Setup</h1>
<p><div id="dependencies"></div></p>
<h2>Dependencies</h2>
<p>Before you get started with synth, there&#39;s a few extra things you need to install first:</p>
<ul>
<li>Node ver. 0.10.0 or higher - <a href="http://nodejs.org">Available for free here</a></li>
<li>NPM ver. 1.3 or higher (It should automatically be installed with Node these days)</li>
<li>MongoDB - <a href="https://www.mongodb.org/">Available for free here</a> - Don&#39;t forget to launch it in the background after installing it.</li>
</ul>
<p><div id="install"></div></p>
<h2>Install Synth</h2>
<p>Synth is available using NPM. Install it globally using npm to access it from the command-line:</p>
<pre><code class="language-bash">npm install -g synth</code></pre>
<p><strong>Note</strong>: You may need to do <code>sudo npm install -g synth</code> if you get any permission errors when attempting to install using the above command.</p>
<p><div id="create-app"></div></p>
<h2>Create a new app</h2>
<pre><code class="language-bash">synth new my_app</code></pre>
<p>This will create a new folder called <code>my_app</code>, you can of course change <code>my_app</code> to anything you like.</p>
<pre><code class="language-bash">cd my_app # Change the working directory to the root of your new web app
synth install -b # Install third-party back-end packages (using npm)
synth install -f # Install third-pary front-end packages (using bower)</code></pre>
<p>Go into your new project and install any third-party back-end and front-end packages.</p>
<p>Even though you have already installed <em>synth</em> globally, in order to use it on the command-line, each project needs its own copy of it. Running <code>synth install -b</code> will install it for you.</p>
<p><strong>Note</strong>:</p>
<ul>
<li>Back-end packages will be installed into <code>my_app/back/node_modules</code>.</li>
<li>Front-end packages will be installed into <code>my_app/front/bower_components</code>.</li>
</ul>
<p><div id="starting"></div></p>
<h2>Starting the app</h2>
<p>To start the app, just run <code>synth server</code> or <code>synth s</code>.</p>
<p>To start it in production mode (where all the assets are minified and concatenated) run <code>synth prod</code> or run <code>synth server</code> with the environment variables <em>NODE_ENV</em> set to &quot;production&quot;.</p>
<p>You can specify the port that the server will listen to by setting the <em>PORT</em> environment variable or by using the <em>-p</em> flag, e.g. <code>-p 3001</code>. 3000 is the default port.</p>
<p><div id="populate-db"></div></p>
<h2>Pre-populate the DB</h2>
<p>Once you point your browser to <a href="http://localhost:3000">http://localhost:3000</a>, you should hopefully see a blank page with a title in the centre saying &quot;Tweets&quot;. But where are the tweets?</p>
<p>Luckily, a little script is included in your project that will populate the DB with randomly generated hipster tweets.</p>
<p>To generate these tweets run:</p>
<pre><code class="language-bash">node back/generateTweets.js</code></pre>
<p>What a few seconds, then refresh the web app and hopefully you should see 20 tweets listed.</p>
<p><div id="publish"></div></p>
<h1>Add ability to &quot;tweet&quot;</h1>
<p>It&#39;s great that we can now see existing tweets, but it&#39;d be awesome if real people could tweet too.</p>
<p>Adding such a feature is done in three steps:</p>
<ol>
<li>Creating a <em>post</em> method on the back-end.</li>
<li>Creating a publish method in the <em>tweetsController</em> on the front-end.</li>
<li>Adding a textarea and button to the view on the front-end.</li>
</ol>
<p><div id="create-post-method"></div></p>
<h2>Creating a <em>post</em> method</h2>
<p>We need an API endpoint that when it&#39;s requested, will create a new entry in our database.</p>
<p>The way that endpoints are added in synth, is by creating a public method inside a the resource folder that the endpoint interacts with. In this case, we&#39;ll be adding a method called <code>post</code> inside a <em>.js</em> file inside of the <code>back/resources/tweets/</code> folder.</p>
<p><strong>Note</strong>: The name of the <em>.js</em> file doesn&#39;t matter to synth, choose a name that suits your needs. The names of the folders inside of <code>back/resources/</code> on the other hand do matter, they determine the URL routes that synth listens to.</p>
<p>Add the following code to a new file located at <code>my_app/back/resources/tweets/createTweets.js</code>:</p>
<pre><code class="language-javascript">exports.post = function (req, res) {
  if (!req.body.content) throw 422;

  return req.db.collection(&#39;tweets&#39;).insert({
    content: req.body.content.slice(0, 140),
    created_at: new Date()
  });
};</code></pre>
<h4>Explanation</h4>
<p>You now have a request handler available at <code>/api/tweets</code> that responds to <strong>POST</strong> requests. The function that responds to the request is invoked in the same way as an express-style request handler, including the <em>req</em> (i.e. request) and <em>res</em> (i.e. response) objects. In this case, if there&#39;s no <em>content</em> field attached to the body of the request, then it sets the reponse code status to 422 and then returns.</p>
<p>If there is content being sent to the request, then it inserts a new document into the mongo DB. The function has access to the DB via <em>req.db</em>. If you take a look at <code>back/back-app.js</code> you&#39;ll see that there is a middleware declared that attaches the the object that represents the connection to the db to any new request object.</p>
<p>You may now be wondering: Why is the function is returning the call to the DB? Synth has built-in support for promises. This means that if the request is a success (i.e. status 200), you can either just return the data that you want returned as JSON, or a promise representing that data. In this app, <em>req.db</em> is provided by a library called <a href="https://github.com/gordonmleigh/promised-mongo">promised-mongo</a>. It allows you to interact with mongo databases and returns a promise as a result. In this case, synth will wait for the promise to be resolved (i.e. for the data to be written to the DB), and then respond to the request with JSON that contains the new tweet.</p>
<p>Without synth&#39;s promise support feature, the request would need to look like this:</p>
<pre><code class="language-javascript">exports.post = function (req, res) {
  if (!req.body.content) return res.send(422);

  req.db.collection(&#39;tweets&#39;).insert({
    content: req.body.content.slice(0, 140),
    created_at: new Date()
  }, function (tweet) {
    res.send( JSON.stringify(tweet) );
  });
};</code></pre>
<p>The above code will still work, but it requires more lines of code. And as they say, more lines of code lead to more chances for bugs!</p>
<p><div id="create-publish-method"></div></p>
<h2>Creating a publish method on the <em>tweetsController</em></h2>
<p>Now that our back-end is ready and willing to add tweets to the DB upon request, we need to add the JS code on the front-end that makes the request.</p>
<p>Inside the <em>tweetsController</em>, found in <code>my_app/front/controllers/tweets.js</code> add the following:</p>
<pre><code class="language-javascript">$scope.publish = function () {
  $http.post(&#39;/api/tweets&#39;, { content: $scope.newTweet })
  .success(function (tweet) {
    $scope.tweets.unshift(tweet);
  });
  $scope.newTweet = &#39;&#39;;
};</code></pre>
<p>You&#39;ll also need to add the <em>$http</em> service to the controller (on line 2):</p>
<pre><code class="language-javascript">.controller(&#39;tweetsController&#39;, function ($scope, $http, data) {</code></pre>
<h4>Explanation</h4>
<p>If you&#39;re familiar with angularjs, then the above should be pretty clear. It fires off a POST request to <code>http://localhost:3000/api/tweets</code> with a JSON request (e.g. <code>{&quot;content&quot;:&quot;An example tweet&quot;}</code>.</p>
<p>And just like synth, angularjs has built-in support for promises. The post request is a promise, and once it has successfully been resolved, it adds the tweet to the list of tweets to be shown to the user.</p>
<p>It also clears out the <em>newtweet</em> field right away, before the http request is resolved, to prevent accidental double posting of the same tweet.</p>
<p><div id="add-textarea-and-button"></div></p>
<h2>Add a textarea and button for publishing tweets</h2>
<p>Now we have front-end and back-end code for publishing tweets, all that remains is the UI for the user to enter their tweet and fire off the <em>publish</em> method.</p>
<p>You&#39;ll find the main view that shows the list of global tweets at <code>my_app/front/html/tweets/getIndex.jade</code>.</p>
<p>Open it up and add the following code to the top of the file:</p>
<pre><code class="language-jade">textarea(ng-model=&quot;newTweet&quot;)
button(ng-click=&quot;publish()&quot;, ng-disabled=&quot;newTweet.length == 0&quot;) Publish</code></pre>
<h4>Explanation</h4>
<p>If you&#39;re not familiar with <a href="http://jade-lang.com/">jade</a>, it&#39;s a much nicer way to write HTML, once you get the hang of it.</p>
<p>The above jade code adds a textarea linked to the <em>newTweet</em> angular model. It then adds a button that fires of the <em>publish</em> method when clicked.</p>
<p>That&#39;s it, you can now publish new tweets!</p>
<h1>Enable links to particular tweets</h1>
<p>Coming soon…</p>
<h1>Add user authentication</h1>
<p>Coming soon…</p>
</div></div></div><div id="footer"><div class="container"><!-- Begin MailChimp Signup Form -->
<div id="mc_embed_signup">
<form action="http://synthjs.us8.list-manage.com/subscribe/post?u=f8e920cca194c0c921f464fdc&amp;id=5c05f681a4" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>

<div class="mc-field-group" style="display: inline-block;">
  <label for="mce-EMAIL">Stay up to date on Synth's latest features and news:</label>
  <input type="email" value="" name="EMAIL" class="required email form-control" id="mce-EMAIL" placeholder="you@fancy-domain.io" style="width: inherit; display: inline-block;">
</div>
<input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button btn btn-default">
  <div id="mce-responses" class="clear">
    <div class="response" id="mce-error-response" style="display:none"></div>
    <div class="response" id="mce-success-response" style="display:none"></div>
  </div>    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
    <div style="position: absolute; left: -5000px;"><input type="text" name="b_f8e920cca194c0c921f464fdc_5c05f681a4" tabindex="-1" value=""></div>
</form>
</div>

<!--End mc_embed_signup-->
<p>Synth was created with warm + fuzzy feelings by <a href="https://twitter.com/JonathanAbrams">Jon Abrams</a></p></div></div><script src="//cdn.jsdelivr.net/g/jquery@2.1,bootstrap@3.1"></script><script src="/bower_components/prismjs/prism.js"></script><script src="/js/main.js"></script><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-49733760-1', 'synthjs.com');
  ga('send', 'pageview');

</script>
</body></html>